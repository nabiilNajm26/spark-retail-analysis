[2024-05-28T16:13:25.992+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-28T16:13:26.012+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: spark_retail_analysis_dag.spark_retail_analysis scheduled__2024-05-27T00:00:00+00:00 [queued]>
[2024-05-28T16:13:26.017+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: spark_retail_analysis_dag.spark_retail_analysis scheduled__2024-05-27T00:00:00+00:00 [queued]>
[2024-05-28T16:13:26.017+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-05-28T16:13:26.024+0000] {taskinstance.py:2330} INFO - Executing <Task(SparkSubmitOperator): spark_retail_analysis> on 2024-05-27 00:00:00+00:00
[2024-05-28T16:13:26.027+0000] {standard_task_runner.py:63} INFO - Started process 3399 to run task
[2024-05-28T16:13:26.030+0000] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'spark_retail_analysis_dag', 'spark_retail_analysis', 'scheduled__2024-05-27T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/spark-retail-dag.py', '--cfg-path', '/tmp/tmp1iadku1w']
[2024-05-28T16:13:26.032+0000] {standard_task_runner.py:91} INFO - Job 8: Subtask spark_retail_analysis
[2024-05-28T16:13:26.044+0000] {logging_mixin.py:188} WARNING - /home/airflow/.local/lib/python3.9/site-packages/airflow/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-05-28T16:13:26.066+0000] {task_command.py:426} INFO - Running <TaskInstance: spark_retail_analysis_dag.spark_retail_analysis scheduled__2024-05-27T00:00:00+00:00 [running]> on host dataeng-airflow-scheduler
[2024-05-28T16:13:26.115+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='dibimbing' AIRFLOW_CTX_DAG_ID='spark_retail_analysis_dag' AIRFLOW_CTX_TASK_ID='spark_retail_analysis' AIRFLOW_CTX_EXECUTION_DATE='2024-05-27T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-05-27T00:00:00+00:00'
[2024-05-28T16:13:26.116+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-28T16:13:26.130+0000] {base.py:84} INFO - Using connection ID 'spark_main' for task execution.
[2024-05-28T16:13:26.131+0000] {spark_submit.py:401} INFO - Spark-Submit cmd: spark-submit --master spark://dataeng-spark-master:7077 --jars /opt/airflow/postgresql-42.2.18.jar --name arrow-spark /spark-scripts/spark-retail-analysis.py
[2024-05-28T16:13:27.188+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2024-05-28T16:13:27.950+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO SparkContext: Running Spark version 3.3.2
[2024-05-28T16:13:27.967+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO ResourceUtils: ==============================================================
[2024-05-28T16:13:27.967+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO ResourceUtils: No custom resources configured for spark.driver.
[2024-05-28T16:13:27.967+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO ResourceUtils: ==============================================================
[2024-05-28T16:13:27.968+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO SparkContext: Submitted application: RetailAnalysis
[2024-05-28T16:13:27.978+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
[2024-05-28T16:13:27.982+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO ResourceProfile: Limiting resource is cpu
[2024-05-28T16:13:27.983+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:27 INFO ResourceProfileManager: Added ResourceProfile id: 0
[2024-05-28T16:13:28.008+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SecurityManager: Changing view acls to: airflow
[2024-05-28T16:13:28.008+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SecurityManager: Changing modify acls to: airflow
[2024-05-28T16:13:28.009+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SecurityManager: Changing view acls groups to:
[2024-05-28T16:13:28.009+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SecurityManager: Changing modify acls groups to:
[2024-05-28T16:13:28.009+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(airflow); groups with view permissions: Set(); users  with modify permissions: Set(airflow); groups with modify permissions: Set()
[2024-05-28T16:13:28.147+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO Utils: Successfully started service 'sparkDriver' on port 34643.
[2024-05-28T16:13:28.163+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SparkEnv: Registering MapOutputTracker
[2024-05-28T16:13:28.191+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SparkEnv: Registering BlockManagerMaster
[2024-05-28T16:13:28.201+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[2024-05-28T16:13:28.202+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
[2024-05-28T16:13:28.205+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
[2024-05-28T16:13:28.217+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-63836b5b-cf83-4f3e-9dfc-df30a79e0951
[2024-05-28T16:13:28.225+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
[2024-05-28T16:13:28.234+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SparkEnv: Registering OutputCommitCoordinator
[2024-05-28T16:13:28.341+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO Utils: Successfully started service 'SparkUI' on port 4040.
[2024-05-28T16:13:28.365+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO SparkContext: Added JAR /opt/airflow/postgresql-42.2.18.jar at spark://dataeng-airflow-scheduler:34643/jars/postgresql-42.2.18.jar with timestamp 1716912807946
[2024-05-28T16:13:28.407+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://dataeng-spark-master:7077...
[2024-05-28T16:13:28.432+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO TransportClientFactory: Successfully created connection to dataeng-spark-master/172.20.0.3:7077 after 14 ms (0 ms spent in bootstraps)
[2024-05-28T16:13:28.506+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240528161328-0006
[2024-05-28T16:13:28.508+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20240528161328-0006/0 on worker-20240528151046-172.20.0.4-37085 (172.20.0.4:37085) with 1 core(s)
[2024-05-28T16:13:28.511+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO StandaloneSchedulerBackend: Granted executor ID app-20240528161328-0006/0 on hostPort 172.20.0.4:37085 with 1 core(s), 1024.0 MiB RAM
[2024-05-28T16:13:28.514+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 35541.
[2024-05-28T16:13:28.514+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO NettyBlockTransferService: Server created on dataeng-airflow-scheduler:35541
[2024-05-28T16:13:28.515+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2024-05-28T16:13:28.518+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, dataeng-airflow-scheduler, 35541, None)
[2024-05-28T16:13:28.520+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManagerMasterEndpoint: Registering block manager dataeng-airflow-scheduler:35541 with 434.4 MiB RAM, BlockManagerId(driver, dataeng-airflow-scheduler, 35541, None)
[2024-05-28T16:13:28.522+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, dataeng-airflow-scheduler, 35541, None)
[2024-05-28T16:13:28.523+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, dataeng-airflow-scheduler, 35541, None)
[2024-05-28T16:13:28.595+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20240528161328-0006/0 is now RUNNING
[2024-05-28T16:13:28.659+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:28 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[2024-05-28T16:13:32.043+0000] {spark_submit.py:571} INFO - Number of rows with null CustomerID: 135080
[2024-05-28T16:13:34.071+0000] {spark_submit.py:571} INFO - Churn Rate: 2.42%
[2024-05-28T16:13:34.072+0000] {spark_submit.py:571} INFO - Monthly Revenue for Customers with Valid CustomerID:
[2024-05-28T16:13:34.812+0000] {spark_submit.py:571} INFO - +-----------+------------------+
[2024-05-28T16:13:34.813+0000] {spark_submit.py:571} INFO - |InvoiceDate|    MonthlyRevenue|
[2024-05-28T16:13:34.813+0000] {spark_submit.py:571} INFO - +-----------+------------------+
[2024-05-28T16:13:34.814+0000] {spark_submit.py:571} INFO - | 2011-01-30| 6456.439999999991|
[2024-05-28T16:13:34.814+0000] {spark_submit.py:571} INFO - | 2011-05-06| 30564.37000000009|
[2024-05-28T16:13:34.814+0000] {spark_submit.py:571} INFO - | 2011-10-07| 48877.55999999985|
[2024-05-28T16:13:34.815+0000] {spark_submit.py:571} INFO - | 2011-01-23| 10285.94999999997|
[2024-05-28T16:13:34.815+0000] {spark_submit.py:571} INFO - | 2011-07-07|26805.669999999987|
[2024-05-28T16:13:34.815+0000] {spark_submit.py:571} INFO - | 2011-07-18|11639.740000000013|
[2024-05-28T16:13:34.816+0000] {spark_submit.py:571} INFO - | 2011-08-21|14539.190000000008|
[2024-05-28T16:13:34.816+0000] {spark_submit.py:571} INFO - | 2011-11-18| 35789.04000000021|
[2024-05-28T16:13:34.816+0000] {spark_submit.py:571} INFO - | 2010-12-15| 29310.79000000012|
[2024-05-28T16:13:34.816+0000] {spark_submit.py:571} INFO - | 2010-12-01| 46051.26000000007|
[2024-05-28T16:13:34.817+0000] {spark_submit.py:571} INFO - | 2011-11-14|          56825.03|
[2024-05-28T16:13:34.817+0000] {spark_submit.py:571} INFO - | 2011-02-21| 32245.14000000008|
[2024-05-28T16:13:34.818+0000] {spark_submit.py:571} INFO - | 2011-04-06| 12639.31000000002|
[2024-05-28T16:13:34.818+0000] {spark_submit.py:571} INFO - | 2011-06-21|          18911.14|
[2024-05-28T16:13:34.818+0000] {spark_submit.py:571} INFO - | 2011-09-04|16903.929999999993|
[2024-05-28T16:13:34.818+0000] {spark_submit.py:571} INFO - | 2011-08-30|            8608.3|
[2024-05-28T16:13:34.819+0000] {spark_submit.py:571} INFO - | 2011-07-06|22852.520000000022|
[2024-05-28T16:13:34.819+0000] {spark_submit.py:571} INFO - | 2011-04-27| 23241.31999999997|
[2024-05-28T16:13:34.819+0000] {spark_submit.py:571} INFO - | 2011-10-23|12302.410000000013|
[2024-05-28T16:13:34.820+0000] {spark_submit.py:571} INFO - | 2011-08-05|19585.120000000068|
[2024-05-28T16:13:34.820+0000] {spark_submit.py:571} INFO - +-----------+------------------+
[2024-05-28T16:13:34.820+0000] {spark_submit.py:571} INFO - only showing top 20 rows
[2024-05-28T16:13:34.820+0000] {spark_submit.py:571} INFO - 
[2024-05-28T16:13:34.821+0000] {spark_submit.py:571} INFO - Customer Retention for Customers with Valid CustomerID:
[2024-05-28T16:13:35.320+0000] {spark_submit.py:571} INFO - +----------+--------------+
[2024-05-28T16:13:35.324+0000] {spark_submit.py:571} INFO - |CustomerID|RetentionCount|
[2024-05-28T16:13:35.324+0000] {spark_submit.py:571} INFO - +----------+--------------+
[2024-05-28T16:13:35.325+0000] {spark_submit.py:571} INFO - |     13192|             2|
[2024-05-28T16:13:35.326+0000] {spark_submit.py:571} INFO - |     15271|            15|
[2024-05-28T16:13:35.327+0000] {spark_submit.py:571} INFO - |     18130|             3|
[2024-05-28T16:13:35.327+0000] {spark_submit.py:571} INFO - |     15574|             3|
[2024-05-28T16:13:35.327+0000] {spark_submit.py:571} INFO - |     16320|             2|
[2024-05-28T16:13:35.329+0000] {spark_submit.py:571} INFO - |     14157|             2|
[2024-05-28T16:13:35.329+0000] {spark_submit.py:571} INFO - |     13610|             7|
[2024-05-28T16:13:35.330+0000] {spark_submit.py:571} INFO - |     14204|             1|
[2024-05-28T16:13:35.330+0000] {spark_submit.py:571} INFO - |     15555|            16|
[2024-05-28T16:13:35.330+0000] {spark_submit.py:571} INFO - |     17686|             5|
[2024-05-28T16:13:35.330+0000] {spark_submit.py:571} INFO - |     13865|             4|
[2024-05-28T16:13:35.331+0000] {spark_submit.py:571} INFO - |     17427|             1|
[2024-05-28T16:13:35.331+0000] {spark_submit.py:571} INFO - |     12847|             1|
[2024-05-28T16:13:35.331+0000] {spark_submit.py:571} INFO - |     16250|             2|
[2024-05-28T16:13:35.332+0000] {spark_submit.py:571} INFO - |     14887|             1|
[2024-05-28T16:13:35.332+0000] {spark_submit.py:571} INFO - |     17714|             1|
[2024-05-28T16:13:35.332+0000] {spark_submit.py:571} INFO - |     13772|             3|
[2024-05-28T16:13:35.332+0000] {spark_submit.py:571} INFO - |     12394|             2|
[2024-05-28T16:13:35.332+0000] {spark_submit.py:571} INFO - |     13282|             3|
[2024-05-28T16:13:35.333+0000] {spark_submit.py:571} INFO - |     15634|             1|
[2024-05-28T16:13:35.333+0000] {spark_submit.py:571} INFO - +----------+--------------+
[2024-05-28T16:13:35.333+0000] {spark_submit.py:571} INFO - only showing top 20 rows
[2024-05-28T16:13:35.333+0000] {spark_submit.py:571} INFO - 
[2024-05-28T16:13:35.333+0000] {spark_submit.py:571} INFO - Average Order Value for Customers with Valid CustomerID:
[2024-05-28T16:13:35.891+0000] {spark_submit.py:571} INFO - +----------+------------------+
[2024-05-28T16:13:35.892+0000] {spark_submit.py:571} INFO - |CustomerID| AverageOrderValue|
[2024-05-28T16:13:35.892+0000] {spark_submit.py:571} INFO - +----------+------------------+
[2024-05-28T16:13:35.892+0000] {spark_submit.py:571} INFO - |     16250| 16.22666666666667|
[2024-05-28T16:13:35.892+0000] {spark_submit.py:571} INFO - |     15574| 4.180059523809525|
[2024-05-28T16:13:35.892+0000] {spark_submit.py:571} INFO - |     15555| 5.143999999999988|
[2024-05-28T16:13:35.893+0000] {spark_submit.py:571} INFO - |     15271| 9.039345454545462|
[2024-05-28T16:13:35.893+0000] {spark_submit.py:571} INFO - |     17714|              15.3|
[2024-05-28T16:13:35.893+0000] {spark_submit.py:571} INFO - |     17686|20.068041958041984|
[2024-05-28T16:13:35.893+0000] {spark_submit.py:571} INFO - |     13865|16.718666666666667|
[2024-05-28T16:13:35.893+0000] {spark_submit.py:571} INFO - |     14157| 8.172040816326534|
[2024-05-28T16:13:35.894+0000] {spark_submit.py:571} INFO - |     13610| 4.892236842105265|
[2024-05-28T16:13:35.894+0000] {spark_submit.py:571} INFO - |     13772| 6.396214689265538|
[2024-05-28T16:13:35.894+0000] {spark_submit.py:571} INFO - |     13282|26.195999999999998|
[2024-05-28T16:13:35.894+0000] {spark_submit.py:571} INFO - |     12394| 47.12888888888889|
[2024-05-28T16:13:35.894+0000] {spark_submit.py:571} INFO - |     16320|18.543928571428573|
[2024-05-28T16:13:35.895+0000] {spark_submit.py:571} INFO - |     13192|14.475238095238097|
[2024-05-28T16:13:35.895+0000] {spark_submit.py:571} INFO - |     14887| 310.3333333333333|
[2024-05-28T16:13:35.895+0000] {spark_submit.py:571} INFO - |     17506|18.393124999999998|
[2024-05-28T16:13:35.895+0000] {spark_submit.py:571} INFO - |     17427|              50.4|
[2024-05-28T16:13:35.895+0000] {spark_submit.py:571} INFO - |     18130|14.728732394366201|
[2024-05-28T16:13:35.896+0000] {spark_submit.py:571} INFO - |     16504| 5.632325581395346|
[2024-05-28T16:13:35.896+0000] {spark_submit.py:571} INFO - |     15269|             204.4|
[2024-05-28T16:13:35.896+0000] {spark_submit.py:571} INFO - +----------+------------------+
[2024-05-28T16:13:35.896+0000] {spark_submit.py:571} INFO - only showing top 20 rows
[2024-05-28T16:13:35.896+0000] {spark_submit.py:571} INFO - 
[2024-05-28T16:13:35.896+0000] {spark_submit.py:571} INFO - Customer Ranking by Total Revenue for Customers with Valid CustomerID:
[2024-05-28T16:13:35.917+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:35 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:35.919+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:35 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:35.920+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:35 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:36.395+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:36 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:36.395+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:36 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:36.396+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:36 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:36.626+0000] {spark_submit.py:571} INFO - +----------+------------------+----+
[2024-05-28T16:13:36.627+0000] {spark_submit.py:571} INFO - |CustomerID|      TotalRevenue|Rank|
[2024-05-28T16:13:36.628+0000] {spark_submit.py:571} INFO - +----------+------------------+----+
[2024-05-28T16:13:36.628+0000] {spark_submit.py:571} INFO - |     14646| 279489.0199999999|   1|
[2024-05-28T16:13:36.628+0000] {spark_submit.py:571} INFO - |     18102|256438.49000000005|   2|
[2024-05-28T16:13:36.628+0000] {spark_submit.py:571} INFO - |     17450|187482.17000000013|   3|
[2024-05-28T16:13:36.628+0000] {spark_submit.py:571} INFO - |     14911| 132572.6199999998|   4|
[2024-05-28T16:13:36.629+0000] {spark_submit.py:571} INFO - |     12415|123725.44999999987|   5|
[2024-05-28T16:13:36.629+0000] {spark_submit.py:571} INFO - |     14156|113384.13999999985|   6|
[2024-05-28T16:13:36.629+0000] {spark_submit.py:571} INFO - |     17511| 88125.37999999996|   7|
[2024-05-28T16:13:36.629+0000] {spark_submit.py:571} INFO - |     16684| 65892.07999999999|   8|
[2024-05-28T16:13:36.629+0000] {spark_submit.py:571} INFO - |     13694| 62653.10000000003|   9|
[2024-05-28T16:13:36.630+0000] {spark_submit.py:571} INFO - |     15311| 59419.34000000011|  10|
[2024-05-28T16:13:36.630+0000] {spark_submit.py:571} INFO - |     13089|57385.880000000114|  11|
[2024-05-28T16:13:36.630+0000] {spark_submit.py:571} INFO - |     14096| 57120.90999999968|  12|
[2024-05-28T16:13:36.630+0000] {spark_submit.py:571} INFO - |     15061| 54228.74000000002|  13|
[2024-05-28T16:13:36.630+0000] {spark_submit.py:571} INFO - |     17949| 52750.84000000001|  14|
[2024-05-28T16:13:36.631+0000] {spark_submit.py:571} INFO - |     15769|          51823.72|  15|
[2024-05-28T16:13:36.631+0000] {spark_submit.py:571} INFO - |     16029| 50992.60999999997|  16|
[2024-05-28T16:13:36.631+0000] {spark_submit.py:571} INFO - |     14298| 50862.43999999997|  17|
[2024-05-28T16:13:36.632+0000] {spark_submit.py:571} INFO - |     14088|          50415.49|  18|
[2024-05-28T16:13:36.632+0000] {spark_submit.py:571} INFO - |     17841| 40340.78000000009|  19|
[2024-05-28T16:13:36.632+0000] {spark_submit.py:571} INFO - |     13798| 36351.41999999996|  20|
[2024-05-28T16:13:36.632+0000] {spark_submit.py:571} INFO - +----------+------------------+----+
[2024-05-28T16:13:36.632+0000] {spark_submit.py:571} INFO - only showing top 20 rows
[2024-05-28T16:13:36.632+0000] {spark_submit.py:571} INFO - 
[2024-05-28T16:13:36.633+0000] {spark_submit.py:571} INFO - Monthly Revenue for Transactions without CustomerID:
[2024-05-28T16:13:36.934+0000] {spark_submit.py:571} INFO - +-----------+-------------------+
[2024-05-28T16:13:36.935+0000] {spark_submit.py:571} INFO - |InvoiceDate|     MonthlyRevenue|
[2024-05-28T16:13:36.936+0000] {spark_submit.py:571} INFO - +-----------+-------------------+
[2024-05-28T16:13:36.936+0000] {spark_submit.py:571} INFO - | 2011-05-06|  5150.210000000006|
[2024-05-28T16:13:36.937+0000] {spark_submit.py:571} INFO - | 2011-10-07|-1339.5399999999865|
[2024-05-28T16:13:36.937+0000] {spark_submit.py:571} INFO - | 2011-07-07|  4552.050000000006|
[2024-05-28T16:13:36.937+0000] {spark_submit.py:571} INFO - | 2011-07-18| 16803.529999999893|
[2024-05-28T16:13:36.938+0000] {spark_submit.py:571} INFO - | 2011-08-21|              10.02|
[2024-05-28T16:13:36.938+0000] {spark_submit.py:571} INFO - | 2011-11-18| 12242.759999999957|
[2024-05-28T16:13:36.939+0000] {spark_submit.py:571} INFO - | 2010-12-15| 132.90000000000003|
[2024-05-28T16:13:36.939+0000] {spark_submit.py:571} INFO - | 2010-12-01| 12584.299999999988|
[2024-05-28T16:13:36.940+0000] {spark_submit.py:571} INFO - | 2011-11-14|           55316.08|
[2024-05-28T16:13:36.940+0000] {spark_submit.py:571} INFO - | 2011-02-21|  -8437.31000000004|
[2024-05-28T16:13:36.940+0000] {spark_submit.py:571} INFO - | 2011-04-06|  4640.040000000004|
[2024-05-28T16:13:36.941+0000] {spark_submit.py:571} INFO - | 2011-06-21| 3818.8700000000126|
[2024-05-28T16:13:36.941+0000] {spark_submit.py:571} INFO - | 2011-09-04| 114.56000000000002|
[2024-05-28T16:13:36.941+0000] {spark_submit.py:571} INFO - | 2011-08-30|  23032.59999999993|
[2024-05-28T16:13:36.941+0000] {spark_submit.py:571} INFO - | 2011-07-06|   3427.06000000001|
[2024-05-28T16:13:36.941+0000] {spark_submit.py:571} INFO - | 2011-04-27|  2349.240000000002|
[2024-05-28T16:13:36.942+0000] {spark_submit.py:571} INFO - | 2011-08-05| 1713.1800000000017|
[2024-05-28T16:13:36.942+0000] {spark_submit.py:571} INFO - | 2011-08-16| 3161.8199999999997|
[2024-05-28T16:13:36.942+0000] {spark_submit.py:571} INFO - | 2011-01-25|  4958.170000000009|
[2024-05-28T16:13:36.942+0000] {spark_submit.py:571} INFO - | 2011-03-27|              16.95|
[2024-05-28T16:13:36.942+0000] {spark_submit.py:571} INFO - +-----------+-------------------+
[2024-05-28T16:13:36.942+0000] {spark_submit.py:571} INFO - only showing top 20 rows
[2024-05-28T16:13:36.943+0000] {spark_submit.py:571} INFO - 
[2024-05-28T16:13:39.069+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:39.070+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:39.072+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:39.460+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:39.461+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:39.536+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:39.538+0000] {spark_submit.py:571} INFO - 24/05/28 16:13:39 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
[2024-05-28T16:13:40.266+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-28T16:13:40.278+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=spark_retail_analysis_dag, task_id=spark_retail_analysis, run_id=scheduled__2024-05-27T00:00:00+00:00, execution_date=20240527T000000, start_date=20240528T161326, end_date=20240528T161340
[2024-05-28T16:13:40.315+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-28T16:13:40.329+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-28T16:13:40.330+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
